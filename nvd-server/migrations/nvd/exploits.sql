create table exploits
(
    id          binary(16)                          not null comment 'exploits表ID'
        primary key,
    name        varchar(128)                        not null,
    description text                                null comment 'exploit描述',
    source      varchar(32)                         not null comment '来源',
    path        varchar(512)                        not null comment '路径',
    meta        json                                not null comment '元数据',
    verified    tinyint                             not null,
    cve_id      varchar(32)                         null comment '关联的CVE编号',
    product_id  binary(16)                          null comment '关联的产品ID',
    created_at  timestamp default CURRENT_TIMESTAMP not null comment '创建时间',
    updated_at  timestamp default CURRENT_TIMESTAMP not null on update CURRENT_TIMESTAMP comment '是否已经验证',
    constraint id_UNIQUE
        unique (id),
    constraint name_UNIQUE
        unique (name),
    constraint source_path_UNIQUE
        unique (source, path),
    constraint exploits_cve
        foreign key (cve_id) references cves (id),
    constraint exploits_product
        foreign key (product_id) references products (id)
)
    comment '漏洞利用表';

create index exploits_cves
    on exploits (cve_id);

create index exploits_products
    on exploits (product_id);

