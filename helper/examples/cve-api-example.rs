use nvd_api::v2::vulnerabilities::{CveHistoryParameters, CveParameters};
// https://cwe.mitre.org/data/downloads.html
// curl -s -k https://cwe.mitre.org/data/downloads.html |grep  -Eo '(/[^"]*\.xml.zip)'|xargs -I % wget -c https://cwe.mitre.org%
#[tokio::main]
async fn main() {
  let api = nvd_api::NVDApi::new(None, "2.0").unwrap();
    let cve = api
        .cve(CveParameters {
            cpe_name: None,
            cve_id: None,
            cvss_v2_metrics: None,
            cvss_v2_severity: None,
            cvss_v3_metrics: None,
            cvss_v3_severity: None,
            cwe_id: None,
            has_cert_alerts: None,
            has_cert_notes: None,
            has_kev: None,
            has_oval: None,
            is_vulnerable: None,
            keyword: None,
            last_mod: None,
            no_rejected: None,
            pub_date: None,
            limit_offset: None,
            source_identifier: None,
            virtual_match: None,
        })
        .await
        .unwrap();
    println!("{:?}", cve.format);
  let cve_history = api
    .cve_history(CveHistoryParameters{
        cve_id: None,
        change_date: None,
        event_name: None,
        limit_offset: None,
    })
    .await
    .unwrap();
  println!("{:?}", cve_history.format);
}
